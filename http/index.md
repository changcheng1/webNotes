<!--
 * @Author: your name
 * @Date: 2020-04-18 12:51:15
 * @LastEditTime: 2020-04-20 15:45:09
 * @LastEditors: Please set LastEditors
 * @Description: In User Settings Edit
 * @FilePath: /webNotes/http/index.md
 -->

### http 发展史

- Http/0.9

> 单一的 Get 请求,相应之后立即关闭

- Http/1.0

  1.增加了 HEAD,Post 等新方法

  2.增加了响应状态码，标记可能错误的原因

  3.引入了协议版本号的概念

  4.引入了 Http Header 概念，让 Http 处理更加灵活

  5.传输的数据不仅仅是文本

  6.不支持长连接

- Http/1.1：是目前互联网使用最广泛的协议

  1.增加了 PUT,DELETE 等新方法

  2.增加了缓存管理和控制

  3.明确了连接管理，允许持久连接

  4.允许响应数据分块，利于传输大文件

  5.强制要求 host 头，让互联网主机托管成为可能

  6.支持长连接

- Http/2.0

  1.二进制协议，不再是纯文本

  2.可发起多个请求，废弃了 1.1 里的管道

  3.使用专用算法压缩头部，减少数据传输量

  4.允许服务器向客户端推送数据

  5.增强了安全性，“事实上”要求加密通信

### 管线化和持久连接

在使用持久连接的情况下，某个连接消息的传递类似于

<font color=red>请求 1 -> 响应 1 -> 请求 2 -> 响应 2</font>

管线化:某个连接上的消息变成了类似这样

<font color=red>请求 1 -> 请求 2 -> 请求 3 -> 响应 1 -> 响应 2 -> 响应 3</font>

### 管线化和持久连接区别

持久连接的一个缺点是请求和响应式是顺序执行的，只有在请求 1 的响应收到之后，才会发送请求 2，而管线化不需要等待上一次请求得到响应就可以进行下一次请求。实现并行发送请求

2. 只有 GET 和 HEAD 要求可以进行管线化，而 POST 则有所限制

3. 初次创建连接时也不应启动管线机制，因为对方（服务器）不一定支持 HTTP/1.1 版本的协议。

4.HTTP1.1 要求服务器端支持管线化，但并不要求服务器端也对响应进行管线化处理，只是要求对于管线化的请求不失败，而且现在很多服务器端和代理程序对管线化的支持并不好，现代浏览器 Chrome 和 Firefox 默认并未开启管线化支持。

### Http 简介

1.TCP/IP 是网络最常用的协议，Http 通常运行在 TCP/IP 提供的可靠传输基础上

2.DNS 域名是 IP 地址的等价代替，需要用域名解析实现到 IP 地址的映射

3.URI 是用来标记互联网上资源的一个名字，由"协议名+主机名+路径"构成，俗称 URL

4.Https 相当于"HTTP+SSL/TLS+TCP/IP"

5.代理是 HTTP 传输过程中的"中转站"，可以实现缓存加速，负载均衡等功能

### OSI(网络协议)

1.第一层：物理层，网络的物理形式，例如电缆，网纤，网卡等

2.第二层：数据链路层，相当于 TCP/IP 的链接层

3.第三层：网络层，相当于 TCP/IP 里的网际层

4.第四层：传输层，相当于 TCP/IP 里的传输层

5.第五层：会话层，维护网络中的连接状态，保持会话同步

6.第六层：表示层，把数据转换成合适，可理解的语法和语义

7.第七层：应用层,面向具体的的应用传输数据

### DNS 重点

1.域名使用字符串代替 IP 地址，方便用户记忆，本质上是一个名字空间系统

2.DNS 像是我们现实中电话本，查号台，是一个“超级大管家”

3.使用 DNS 可以实现基于域名的负载均衡，既可以在内网，也可以在外网

### DNS 查询

根域名->顶级域名(com)->域名服务器

1.先访问根域名服务器，它会告诉你“com”的顶级域名服务器地址

2.再访问"com"顶级域名服务器，它再告诉我"apple.com"域名服务器的地址

3.最后访问"apple.com"域名服务器，就得到了"www.apple.com"的地址

### 域名解析

1.因为域名解析可以返回多个 IP 地址，所以一个域名可以对应多个主机，客户收到多个 IP 地址后，就可以使用轮询算法向服务器发起请求，实现负载均衡

2.第二种方式，域名解析可以配置内部策略，返回客户端最近的主机，或者返回当前服务质量最好的主机，这样在 DNS 端把请求分发到不同服务器上，实现负载均衡

### 在浏览器中输入了"www.bdidu.com"的 DNS 解析过程

浏览器缓存->操作系统缓存->host 文件->根域名->顶级域服务器，返回失败

### TCP 连接的三次握手四次挥手

TCP 三次握手：<br/>
1、客户端发送 syn 包到服务器，等待服务器确认接收。<br/>
2、服务器确认接收 syn 包并确认客户的 syn，并发送回来一个 syn+ack 的包给客户端。<br/>
3、客户端确认接收服务器的 syn+ack 包，并向服务器发送确认包 ack，二者相互建立联系后，完成 tcp 三次握手。四次挥手就是中间多了一层 等待服务器再一次响应回复相关数据的过程

![avatar](./img/tcp.png)

### Http 默认端口 80 Https 默认端口 443
